<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

  <!-- PWA Manifest -->
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="icon-192.png">

  <title>Pizzeria Roma</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">

  <style>
    /* ========================================
       FLOW PWA TEMPLATE v2.0
       Med header billede support
    ======================================== */

    :root {
      /* Brand Colors - Injected from config */
      --brand-primary: #D4380D;
      --brand-primary-dark: #B91C1C;
      --brand-secondary: #FFF7E6;
      --brand-accent: #F59E0B;

      /* System Colors */
      --white: #FFFFFF;
      --black: #0A0A0A;
      --gray-50: #FAFAFA;
      --gray-100: #F4F4F5;
      --gray-200: #E4E4E7;
      --gray-300: #D4D4D8;
      --gray-400: #A1A1AA;
      --gray-500: #71717A;
      --gray-600: #52525B;
      --gray-700: #3F3F46;
      --gray-800: #27272A;
      --gray-900: #18181B;

      /* Semantic */
      --success: #10B981;
      --warning: #F59E0B;
      --error: #EF4444;

      /* Spacing */
      --space-xs: 4px;
      --space-sm: 8px;
      --space-md: 16px;
      --space-lg: 24px;
      --space-xl: 32px;
      --space-2xl: 48px;

      /* Radius */
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
      --radius-full: 9999px;

      /* Shadows */
      --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
      --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
      --shadow-lg: 0 12px 40px rgba(0,0,0,0.12);
      --shadow-xl: 0 24px 60px rgba(0,0,0,0.16);

      /* Safe areas for notch */
      --safe-top: env(safe-area-inset-top);
      --safe-bottom: env(safe-area-inset-bottom);

      /* Header height */
      --header-image-height: 280px;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      height: 100%;
      overflow: hidden;
    }

    body {
      font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--white);
      color: var(--gray-900);
      line-height: 1.5;
      -webkit-font-smoothing: antialiased;
    }

    /* ========================================
       APP SHELL
    ======================================== */

    .app {
      display: flex;
      flex-direction: column;
      height: 100%;
      max-width: 480px;
      margin: 0 auto;
      background: var(--white);
      position: relative;
      overflow: hidden;
    }

    /* ========================================
       HERO HEADER WITH IMAGE
    ======================================== */

    .hero-header {
      position: relative;
      height: var(--header-image-height);
      min-height: var(--header-image-height);
      overflow: hidden;
      flex-shrink: 0;
      transition: height 0.05s ease-out, min-height 0.05s ease-out, opacity 0.1s ease-out;
    }

    .hero-header-image {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s ease;
    }

    .hero-header-placeholder {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
    }

    /* Gradient overlay for readability */
    .hero-header-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        to bottom,
        rgba(0, 0, 0, 0.25) 0%,
        rgba(0, 0, 0, 0) 25%,
        rgba(0, 0, 0, 0) 45%,
        rgba(0, 0, 0, 0.15) 65%,
        rgba(0, 0, 0, 0.3) 75%,
        rgba(255, 255, 255, 0.5) 88%,
        rgba(255, 255, 255, 0.85) 94%,
        rgba(255, 255, 255, 1) 100%
      );
      pointer-events: none;
    }

    /* Extra soft fade at bottom of header */
    .hero-header::after {
      content: '';
      position: absolute;
      bottom: -40px;
      left: 0;
      right: 0;
      height: 80px;
      background: linear-gradient(
        to bottom,
        rgba(255, 255, 255, 0) 0%,
        rgba(255, 255, 255, 1) 100%
      );
      pointer-events: none;
      z-index: 15;
    }

    /* Top navigation on image */
    .hero-header-nav {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: var(--space-md) var(--space-lg);
      padding-top: calc(var(--safe-top, 44px) + var(--space-md));
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 10;
    }

    .header-btn {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: var(--shadow-md);
    }

    .header-btn:active {
      transform: scale(0.95);
    }

    .header-btn svg {
      width: 20px;
      height: 20px;
      color: var(--gray-800);
    }

    .header-btn-group {
      display: flex;
      gap: var(--space-sm);
    }

    .header-btn.has-badge {
      position: relative;
    }

    .header-btn .badge {
      position: absolute;
      top: -4px;
      right: -4px;
      min-width: 20px;
      height: 20px;
      background: var(--brand-primary);
      color: var(--white);
      font-size: 11px;
      font-weight: 700;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 6px;
      border: 2px solid var(--white);
    }

    /* Restaurant info overlay on image */
    .hero-header-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: var(--space-lg);
      padding-bottom: calc(var(--space-xl) + 20px);
      z-index: 10;
    }

    .restaurant-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      border-radius: var(--radius-full);
      font-size: 12px;
      font-weight: 600;
      color: var(--gray-800);
      margin-bottom: var(--space-md);
      box-shadow: var(--shadow-sm);
    }

    .restaurant-badge .dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--success);
    }

    .restaurant-name {
      font-size: 28px;
      font-weight: 800;
      color: var(--white);
      letter-spacing: -0.5px;
      margin-bottom: var(--space-xs);
      text-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }

    .restaurant-tagline {
      font-size: 14px;
      color: rgba(255, 255, 255, 0.9);
      text-shadow: 0 1px 4px rgba(0,0,0,0.3);
    }

    /* ========================================
       CONTENT AREA
    ======================================== */

    .app-content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
      padding-bottom: calc(80px + var(--safe-bottom, 20px));
      background: transparent;
      position: relative;
      z-index: 20;

      /* Hide scrollbar */
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .app-content::-webkit-scrollbar {
      display: none;
    }

    /* Content wrapper with white background */
    .content-wrapper {
      background: var(--white);
      min-height: 100%;
      position: relative;
    }

    /* ========================================
       HIDE ALL SCROLLBARS
    ======================================== */

    * {
      scrollbar-width: none !important;
      -ms-overflow-style: none !important;
    }

    *::-webkit-scrollbar {
      display: none !important;
      width: 0 !important;
      height: 0 !important;
    }

    /* ========================================
       APP VIEWS / PAGES
    ======================================== */

    .app-view {
      display: none;
      flex-direction: column;
      height: 100%;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .app-view.active {
      display: flex;
      opacity: 1;
    }

    /* Search View */
    .search-view {
      padding: var(--space-lg);
      padding-top: calc(var(--safe-top, 44px) + var(--space-lg));
      flex: 1;
      overflow-y: auto;
    }

    .search-view-header {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
    }

    .search-view-back {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--gray-100);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .search-view-back svg {
      width: 20px;
      height: 20px;
      color: var(--gray-700);
    }

    .search-view-input {
      flex: 1;
      padding: var(--space-md) var(--space-lg);
      background: var(--gray-100);
      border: none;
      border-radius: var(--radius-lg);
      font-size: 16px;
      font-family: inherit;
    }

    .search-view-input:focus {
      outline: none;
      background: var(--gray-200);
    }

    .search-recent {
      margin-bottom: var(--space-xl);
    }

    .search-section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--space-md);
    }

    .search-recent-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md) 0;
      border-bottom: 1px solid var(--gray-100);
      cursor: pointer;
    }

    .search-recent-item svg {
      width: 20px;
      height: 20px;
      color: var(--gray-400);
    }

    .search-recent-item span {
      flex: 1;
      font-size: 15px;
      color: var(--gray-700);
    }

    .search-popular-tags {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-sm);
    }

    .search-tag {
      padding: var(--space-sm) var(--space-md);
      background: var(--gray-100);
      border-radius: var(--radius-full);
      font-size: 14px;
      color: var(--gray-700);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .search-tag:active {
      background: var(--brand-primary);
      color: var(--white);
    }

    /* Points/Loyalty View */
    .points-view {
      padding-top: calc(var(--safe-top, 44px));
      overflow-y: auto;
      flex: 1;
      padding-bottom: calc(100px + var(--safe-bottom, 20px));
    }

    .points-header {
      padding: var(--space-xl) var(--space-lg);
      background: linear-gradient(135deg, var(--gray-900) 0%, var(--gray-800) 100%);
      color: var(--white);
      text-align: center;
    }

    .points-value-large {
      font-size: 64px;
      font-weight: 800;
      letter-spacing: -2px;
      margin-bottom: var(--space-xs);
    }

    .points-label {
      font-size: 16px;
      color: var(--gray-400);
      margin-bottom: var(--space-lg);
    }

    .points-progress-large {
      background: var(--gray-700);
      height: 8px;
      border-radius: var(--radius-full);
      overflow: hidden;
      margin-bottom: var(--space-sm);
    }

    .points-progress-large-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--brand-accent) 0%, #FBBF24 100%);
      border-radius: var(--radius-full);
    }

    .points-progress-text {
      font-size: 13px;
      color: var(--gray-400);
    }

    .points-content {
      padding: var(--space-lg);
      padding-bottom: var(--space-2xl);
    }

    .rewards-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-md);
      margin-bottom: var(--space-xl);
    }

    .reward-card {
      background: var(--white);
      border: 2px solid var(--gray-100);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      text-align: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .reward-card:active {
      border-color: var(--brand-primary);
      transform: scale(0.98);
    }

    .reward-card.locked {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .reward-card.available {
      border-color: var(--success);
      cursor: pointer;
    }

    .reward-card.available:active {
      border-color: var(--success);
      background: rgba(16, 185, 129, 0.05);
      transform: scale(0.98);
    }

    .reward-status {
      font-size: 10px;
      margin-top: var(--space-xs);
      padding: 2px 8px;
      border-radius: var(--radius-full);
    }

    .reward-status.available-text {
      background: rgba(16, 185, 129, 0.1);
      color: var(--success);
      font-weight: 600;
    }

    .reward-emoji {
      font-size: 40px;
      margin-bottom: var(--space-sm);
    }

    .reward-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: var(--space-xs);
    }

    .reward-points {
      font-size: 12px;
      color: var(--brand-primary);
      font-weight: 600;
    }

    .points-history {
      background: var(--gray-50);
      border-radius: var(--radius-lg);
      padding: var(--space-lg);
      margin-bottom: var(--space-xl);
    }

    .history-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: var(--space-md) 0;
      border-bottom: 1px solid var(--gray-200);
    }

    .history-item:last-child {
      border-bottom: none;
    }

    .history-info h4 {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .history-info span {
      font-size: 12px;
      color: var(--gray-500);
    }

    .history-points {
      font-size: 14px;
      font-weight: 700;
    }

    .history-points.positive {
      color: var(--success);
    }

    .history-points.negative {
      color: var(--gray-500);
    }

    /* Profile View */
    .profile-view {
      padding-top: calc(var(--safe-top, 44px));
      overflow-y: auto;
      flex: 1;
    }

    .profile-header {
      padding: var(--space-xl) var(--space-lg);
      text-align: center;
      border-bottom: 1px solid var(--gray-100);
    }

    .profile-avatar {
      width: 80px;
      height: 80px;
      border-radius: var(--radius-full);
      background: linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-md);
      font-size: 32px;
      color: var(--white);
      font-weight: 700;
    }

    .profile-name {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: var(--space-xs);
    }

    .profile-email {
      font-size: 14px;
      color: var(--gray-500);
    }

    .profile-stats {
      display: flex;
      justify-content: center;
      gap: var(--space-xl);
      margin-top: var(--space-lg);
    }

    .profile-stat {
      text-align: center;
    }

    .profile-stat-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--brand-primary);
    }

    .profile-stat-label {
      font-size: 12px;
      color: var(--gray-500);
    }

    .profile-menu {
      padding: var(--space-lg);
    }

    .profile-menu-item {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md) 0;
      border-bottom: 1px solid var(--gray-100);
      cursor: pointer;
    }

    .profile-menu-item svg {
      width: 22px;
      height: 22px;
      color: var(--gray-500);
    }

    .profile-menu-item span {
      flex: 1;
      font-size: 15px;
      font-weight: 500;
    }

    .profile-menu-item .chevron {
      width: 18px;
      height: 18px;
      color: var(--gray-400);
    }

    .profile-menu-item.danger span {
      color: var(--error);
    }

    .profile-menu-item.danger svg {
      color: var(--error);
    }

    /* Offers View */
    .offers-view {
      padding-top: calc(var(--safe-top, 44px));
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow-y: auto;
    }

    .offers-header {
      padding: var(--space-lg);
      border-bottom: 1px solid var(--gray-100);
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: var(--white);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    .offers-header h2 {
      font-size: 20px;
      font-weight: 700;
    }

    .offers-back {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--gray-100);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .offers-back svg {
      width: 20px;
      height: 20px;
      color: var(--gray-700);
    }

    .offers-content {
      padding: var(--space-lg);
      padding-bottom: calc(100px + var(--safe-bottom, 20px));
    }

    .offer-card {
      background: var(--white);
      border-radius: var(--radius-xl);
      overflow: hidden;
      margin-bottom: var(--space-lg);
      box-shadow: var(--shadow-md);
      border: 1px solid var(--gray-100);
    }

    .offer-card-header {
      background: linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-dark) 100%);
      padding: var(--space-lg);
      color: var(--white);
    }

    .offer-card-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: rgba(255,255,255,0.2);
      border-radius: var(--radius-full);
      font-size: 11px;
      font-weight: 600;
      margin-bottom: var(--space-sm);
    }

    .offer-card-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: var(--space-xs);
    }

    .offer-card-subtitle {
      font-size: 14px;
      opacity: 0.9;
    }

    .offer-card-content {
      padding: var(--space-lg);
    }

    .offer-card-details {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      margin-bottom: var(--space-lg);
    }

    .offer-card-prices {
      display: flex;
      align-items: baseline;
      gap: var(--space-sm);
    }

    .offer-original-price {
      font-size: 16px;
      color: var(--gray-400);
      text-decoration: line-through;
    }

    .offer-sale-price {
      font-size: 24px;
      font-weight: 700;
      color: var(--brand-primary);
    }

    .offer-card-conditions {
      font-size: 12px;
      color: var(--gray-500);
      margin-bottom: var(--space-lg);
      padding: var(--space-sm) var(--space-md);
      background: var(--gray-50);
      border-radius: var(--radius-md);
    }

    .offer-add-btn {
      width: 100%;
      padding: var(--space-md);
      background: var(--brand-primary);
      color: var(--white);
      border: none;
      border-radius: var(--radius-lg);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .offer-add-btn:active {
      background: var(--brand-primary-dark);
      transform: scale(0.98);
    }

    /* Cart View */
    .cart-view {
      padding-top: calc(var(--safe-top, 44px));
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    .cart-header {
      padding: var(--space-lg);
      border-bottom: 1px solid var(--gray-100);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .cart-header h2 {
      font-size: 20px;
      font-weight: 700;
    }

    .cart-back {
      width: 40px;
      height: 40px;
      border-radius: var(--radius-full);
      background: var(--gray-100);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .cart-back svg {
      width: 20px;
      height: 20px;
      color: var(--gray-700);
    }

    .cart-clear {
      font-size: 14px;
      color: var(--brand-primary);
      background: none;
      border: none;
      cursor: pointer;
      font-weight: 600;
    }

    .cart-items {
      flex: 1;
      overflow-y: auto;
      padding: var(--space-lg);
    }

    .cart-item {
      display: flex;
      gap: var(--space-md);
      padding: var(--space-md) 0;
      border-bottom: 1px solid var(--gray-100);
    }

    .cart-item-image {
      width: 70px;
      height: 70px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 30px;
      background: var(--gray-100);
    }

    .cart-item-info {
      flex: 1;
    }

    .cart-item-name {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .cart-item-price {
      font-size: 14px;
      color: var(--brand-primary);
      font-weight: 600;
    }

    .cart-item-customization {
      font-size: 11px;
      margin-bottom: 4px;
      line-height: 1.3;
    }

    .cart-item-customization.removed {
      color: var(--gray-500);
      font-style: italic;
    }

    .cart-item-customization.added {
      color: var(--success);
    }

    .cart-item-qty {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      margin-top: var(--space-sm);
    }

    .cart-item-qty button {
      width: 28px;
      height: 28px;
      border-radius: var(--radius-full);
      border: 1px solid var(--gray-200);
      background: var(--white);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .cart-item-qty span {
      font-size: 14px;
      font-weight: 600;
      min-width: 24px;
      text-align: center;
    }

    .cart-empty {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      padding: var(--space-xl);
    }

    .cart-empty-icon {
      font-size: 60px;
      margin-bottom: var(--space-lg);
      opacity: 0.5;
    }

    .cart-empty h3 {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: var(--space-sm);
    }

    .cart-empty p {
      font-size: 14px;
      color: var(--gray-500);
    }

    .cart-footer {
      padding: var(--space-lg);
      border-top: 1px solid var(--gray-100);
      background: var(--white);
    }

    .cart-subtotal {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--space-sm);
      font-size: 14px;
      color: var(--gray-600);
    }

    .cart-total {
      display: flex;
      justify-content: space-between;
      margin-bottom: var(--space-lg);
      font-size: 18px;
      font-weight: 700;
    }

    .cart-checkout {
      width: 100%;
      padding: var(--space-md);
      background: var(--brand-primary);
      color: var(--white);
      border: none;
      border-radius: var(--radius-lg);
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .cart-checkout:active {
      background: var(--brand-primary-dark);
      transform: scale(0.98);
    }

    /* ========================================
       PRODUCT MODAL
    ======================================== */

    .product-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      display: flex;
      align-items: flex-end;
      justify-content: center;
    }

    .product-modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .product-modal {
      width: 100%;
      max-width: 480px;
      max-height: 90vh;
      background: var(--white);
      border-radius: var(--radius-xl) var(--radius-xl) 0 0;
      transform: translateY(100%);
      transition: transform 0.3s ease;
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }

    .product-modal-overlay.visible .product-modal {
      transform: translateY(0);
    }

    .product-modal-image {
      width: 100%;
      height: 250px;
      position: relative;
      overflow: hidden;
    }

    .product-modal-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .product-modal-image-placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 80px;
      background: linear-gradient(135deg, #FED7AA 0%, #FDBA74 100%);
    }

    .product-modal-close {
      position: absolute;
      top: var(--space-md);
      right: var(--space-md);
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      background: var(--white);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: var(--shadow-md);
      z-index: 10;
    }

    .product-modal-close svg {
      width: 20px;
      height: 20px;
      color: var(--gray-700);
    }

    .product-modal-badge {
      position: absolute;
      top: var(--space-md);
      left: var(--space-md);
      padding: 6px 12px;
      background: var(--brand-primary);
      color: var(--white);
      font-size: 12px;
      font-weight: 700;
      border-radius: var(--radius-full);
      text-transform: uppercase;
    }

    .product-modal-content {
      padding: var(--space-lg);
      flex: 1;
      overflow-y: auto;
    }

    .product-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: var(--space-md);
    }

    .product-modal-name {
      font-size: 24px;
      font-weight: 700;
      letter-spacing: -0.5px;
      color: var(--gray-900);
    }

    .product-modal-price {
      font-size: 22px;
      font-weight: 700;
      color: var(--brand-primary);
      white-space: nowrap;
    }

    .product-modal-desc {
      font-size: 15px;
      color: var(--gray-600);
      line-height: 1.6;
      margin-bottom: var(--space-lg);
    }

    .product-modal-section {
      margin-bottom: var(--space-lg);
    }

    .product-modal-section-title {
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-500);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: var(--space-sm);
    }

    .product-modal-ingredients {
      display: flex;
      flex-wrap: wrap;
      gap: var(--space-sm);
    }

    .ingredient-tag {
      padding: 6px 12px;
      background: var(--gray-100);
      border-radius: var(--radius-full);
      font-size: 13px;
      color: var(--gray-700);
    }

    /* Toggleable ingredients */
    .ingredient-tag.toggleable {
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      gap: 6px;
      user-select: none;
    }

    .ingredient-tag.toggleable:active {
      transform: scale(0.95);
    }

    .ingredient-tag.removed {
      background: var(--gray-200);
      color: var(--gray-400);
      text-decoration: line-through;
    }

    .ingredient-check {
      width: 16px;
      height: 16px;
      border: 2px solid var(--gray-400);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .ingredient-tag:not(.removed) .ingredient-check {
      background: var(--success);
      border-color: var(--success);
    }

    .ingredient-check svg {
      width: 10px;
      height: 10px;
      color: var(--white);
    }

    .ingredient-tag.removed .ingredient-check svg {
      display: none;
    }

    /* Extras/Tilbeh√∏r section */
    .product-modal-extras {
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
    }

    .extra-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-md);
      background: var(--gray-50);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .extra-item:active {
      transform: scale(0.98);
    }

    .extra-item.selected {
      background: var(--brand-secondary);
      border: 2px solid var(--brand-primary);
    }

    .extra-item:not(.selected) {
      border: 2px solid transparent;
    }

    .extra-item-left {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }

    .extra-checkbox {
      width: 20px;
      height: 20px;
      border: 2px solid var(--gray-300);
      border-radius: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .extra-item.selected .extra-checkbox {
      background: var(--brand-primary);
      border-color: var(--brand-primary);
    }

    .extra-checkbox svg {
      width: 12px;
      height: 12px;
      color: var(--white);
      opacity: 0;
    }

    .extra-item.selected .extra-checkbox svg {
      opacity: 1;
    }

    .extra-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--gray-800);
    }

    .extra-price {
      font-size: 14px;
      font-weight: 600;
      color: var(--brand-primary);
    }

    /* Quantity selector */
    .quantity-selector {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md);
      background: var(--gray-50);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-lg);
    }

    .quantity-selector label {
      font-size: 14px;
      font-weight: 600;
      color: var(--gray-700);
      flex: 1;
    }

    .quantity-controls {
      display: flex;
      align-items: center;
      gap: var(--space-md);
    }

    .quantity-btn {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      border: 2px solid var(--gray-200);
      background: var(--white);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .quantity-btn:active {
      background: var(--gray-100);
      transform: scale(0.95);
    }

    .quantity-btn svg {
      width: 18px;
      height: 18px;
      color: var(--gray-700);
    }

    .quantity-value {
      font-size: 18px;
      font-weight: 700;
      min-width: 30px;
      text-align: center;
    }

    /* Add to cart button */
    .add-to-cart-btn {
      width: 100%;
      padding: var(--space-md) var(--space-lg);
      background: var(--brand-primary);
      color: var(--white);
      border: none;
      border-radius: var(--radius-lg);
      font-size: 16px;
      font-weight: 600;
      font-family: inherit;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      transition: all 0.2s ease;
    }

    .add-to-cart-btn:active {
      transform: scale(0.98);
      background: var(--brand-primary-dark);
    }

    .add-to-cart-btn svg {
      width: 20px;
      height: 20px;
    }

    /* Redeem Modal */
    .redeem-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-lg);
    }

    .redeem-modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .redeem-modal {
      background: var(--white);
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      max-width: 340px;
      width: 100%;
      text-align: center;
      transform: scale(0.9);
      transition: transform 0.3s ease;
      position: relative;
    }

    .redeem-modal-overlay.visible .redeem-modal {
      transform: scale(1);
    }

    .redeem-modal-close {
      position: absolute;
      top: var(--space-md);
      right: var(--space-md);
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--gray-100);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .redeem-modal-close svg {
      width: 18px;
      height: 18px;
      color: var(--gray-600);
    }

    .redeem-modal-emoji {
      font-size: 60px;
      margin-bottom: var(--space-md);
    }

    .redeem-modal-title {
      font-size: 22px;
      font-weight: 700;
      margin-bottom: var(--space-xs);
    }

    .redeem-modal-desc {
      font-size: 14px;
      color: var(--gray-500);
      margin-bottom: var(--space-lg);
    }

    .redeem-modal-cost,
    .redeem-modal-after {
      display: flex;
      justify-content: space-between;
      padding: var(--space-sm) 0;
      border-bottom: 1px solid var(--gray-100);
      font-size: 14px;
    }

    .redeem-modal-cost span:last-child,
    .redeem-modal-after span:last-child {
      font-weight: 600;
    }

    .redeem-modal-buttons {
      display: flex;
      gap: var(--space-md);
      margin-top: var(--space-lg);
    }

    .redeem-cancel-btn,
    .redeem-confirm-btn {
      flex: 1;
      padding: var(--space-md);
      border-radius: var(--radius-lg);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .redeem-cancel-btn {
      background: var(--gray-100);
      color: var(--gray-700);
      border: none;
    }

    .redeem-confirm-btn {
      background: var(--success);
      color: var(--white);
      border: none;
    }

    .redeem-confirm-btn:active {
      transform: scale(0.98);
    }

    /* History Detail Modal */
    .history-detail-modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 3000;
      opacity: 0;
      visibility: hidden;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: var(--space-lg);
    }

    .history-detail-modal-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    .history-detail-modal {
      background: var(--white);
      border-radius: var(--radius-xl);
      padding: var(--space-xl);
      max-width: 340px;
      width: 100%;
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }

    .history-detail-modal-overlay.visible .history-detail-modal {
      transform: scale(1);
    }

    .history-detail-close {
      position: absolute;
      top: var(--space-md);
      right: var(--space-md);
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--gray-100);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
    }

    .history-detail-close svg {
      width: 18px;
      height: 18px;
      color: var(--gray-600);
    }

    #historyDetailContent h3 {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: var(--space-xs);
    }

    .history-detail-date {
      font-size: 14px;
      color: var(--gray-500);
      margin-bottom: var(--space-lg);
    }

    .history-detail-items {
      margin-bottom: var(--space-lg);
    }

    .history-detail-items h4 {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: var(--space-sm);
    }

    .history-detail-items ul {
      list-style: none;
      padding: 0;
    }

    .history-detail-items li {
      padding: var(--space-sm) 0;
      border-bottom: 1px solid var(--gray-100);
      font-size: 14px;
    }

    .history-detail-reward {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: var(--space-lg);
      padding: var(--space-md);
      background: var(--gray-50);
      border-radius: var(--radius-md);
      text-align: center;
    }

    .history-detail-points {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: var(--space-lg);
      text-align: center;
    }

    .history-detail-points.positive {
      color: var(--success);
    }

    .history-detail-points.negative {
      color: var(--gray-500);
    }

    .history-reorder-btn,
    .history-close-btn {
      width: 100%;
      padding: var(--space-md);
      border-radius: var(--radius-lg);
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
    }

    .history-reorder-btn {
      background: var(--brand-primary);
      color: var(--white);
    }

    .history-close-btn {
      background: var(--gray-100);
      color: var(--gray-700);
    }

    /* Search Bar */
    .search-section {
      padding: var(--space-lg) var(--space-lg);
      padding-top: var(--space-sm);
    }

    .search-bar {
      display: flex;
      align-items: center;
      gap: var(--space-md);
      padding: var(--space-md);
      background: var(--gray-100);
      border-radius: var(--radius-lg);
    }

    .search-bar svg {
      width: 20px;
      height: 20px;
      color: var(--gray-400);
      flex-shrink: 0;
    }

    .search-bar input {
      flex: 1;
      border: none;
      background: transparent;
      font-size: 15px;
      font-family: inherit;
      color: var(--gray-900);
    }

    .search-bar input::placeholder {
      color: var(--gray-400);
    }

    .search-bar input:focus {
      outline: none;
    }

    /* Quick Info Row */
    .quick-info {
      display: flex;
      gap: var(--space-sm);
      padding: 0 var(--space-lg);
      margin-bottom: var(--space-lg);
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .quick-info::-webkit-scrollbar {
      display: none;
    }

    .quick-info-item {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
      padding: var(--space-sm) var(--space-md);
      background: var(--gray-50);
      border-radius: var(--radius-full);
      font-size: 13px;
      color: var(--gray-600);
      white-space: nowrap;
      flex-shrink: 0;
    }

    .quick-info-item svg {
      width: 16px;
      height: 16px;
      color: var(--gray-400);
    }

    .quick-info-item.highlight {
      background: var(--brand-secondary);
      color: var(--brand-primary);
    }

    .quick-info-item.highlight svg {
      color: var(--brand-primary);
    }

    /* Promo Banner */
    .promo-banner {
      margin: 0 var(--space-lg) var(--space-lg);
      padding: var(--space-lg);
      background: linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-dark) 100%);
      border-radius: var(--radius-xl);
      color: var(--white);
      position: relative;
      overflow: hidden;
    }

    .promo-banner::before {
      content: '';
      position: absolute;
      top: -50%;
      right: -30%;
      width: 200px;
      height: 200px;
      background: rgba(255,255,255,0.1);
      border-radius: 50%;
    }

    .promo-content {
      position: relative;
      z-index: 1;
    }

    .promo-label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: rgba(255,255,255,0.2);
      border-radius: var(--radius-full);
      font-size: 11px;
      font-weight: 600;
      margin-bottom: var(--space-sm);
    }

    .promo-title {
      font-size: 20px;
      font-weight: 700;
      margin-bottom: var(--space-xs);
    }

    .promo-subtitle {
      font-size: 13px;
      opacity: 0.9;
    }

    /* Loyalty Card */
    .loyalty-card {
      margin: 0 var(--space-lg) var(--space-lg);
      padding: var(--space-lg);
      background: var(--gray-900);
      border-radius: var(--radius-xl);
      color: var(--white);
    }

    .loyalty-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--space-md);
    }

    .loyalty-label {
      font-size: 12px;
      color: var(--gray-400);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .loyalty-points {
      display: flex;
      align-items: baseline;
      gap: 4px;
    }

    .loyalty-points-value {
      font-size: 28px;
      font-weight: 800;
      letter-spacing: -1px;
    }

    .loyalty-points-label {
      font-size: 13px;
      color: var(--gray-400);
    }

    .loyalty-progress {
      margin-bottom: var(--space-sm);
    }

    .loyalty-progress-bar {
      height: 6px;
      background: var(--gray-700);
      border-radius: var(--radius-full);
      overflow: hidden;
    }

    .loyalty-progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--brand-accent) 0%, #FBBF24 100%);
      border-radius: var(--radius-full);
      transition: width 0.5s ease;
    }

    .loyalty-progress-text {
      display: flex;
      justify-content: space-between;
      margin-top: var(--space-sm);
      font-size: 11px;
      color: var(--gray-400);
    }

    /* Categories */
    .categories {
      padding: var(--space-md) 0;
    }

    .categories-scroll {
      display: flex;
      gap: var(--space-sm);
      overflow-x: auto;
      padding: 0 var(--space-lg);
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }

    .categories-scroll::-webkit-scrollbar {
      display: none;
    }

    .category-chip {
      flex-shrink: 0;
      padding: var(--space-sm) var(--space-lg);
      background: var(--gray-100);
      border: none;
      border-radius: var(--radius-full);
      font-size: 14px;
      font-weight: 500;
      font-family: inherit;
      color: var(--gray-600);
      cursor: pointer;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    .category-chip.active {
      background: var(--gray-900);
      color: var(--white);
    }

    .category-chip:active {
      transform: scale(0.97);
    }

    /* Section */
    .section {
      padding: var(--space-lg);
    }

    .section-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--space-lg);
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      letter-spacing: -0.3px;
    }

    .section-link {
      font-size: 14px;
      font-weight: 600;
      color: var(--brand-primary);
      text-decoration: none;
    }

    /* Menu Grid */
    .menu-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-md);
    }

    /* Menu Card */
    .menu-card {
      background: var(--white);
      border-radius: var(--radius-lg);
      overflow: hidden;
      box-shadow: var(--shadow-sm);
      border: 1px solid var(--gray-100);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .menu-card:active {
      transform: scale(0.98);
      box-shadow: var(--shadow-md);
    }

    .menu-card-image {
      aspect-ratio: 1;
      background: linear-gradient(135deg, #FED7AA 0%, #FDBA74 100%);
      position: relative;
      overflow: hidden;
    }

    .menu-card-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .menu-card-badge {
      position: absolute;
      top: var(--space-sm);
      left: var(--space-sm);
      padding: 4px 10px;
      background: var(--brand-primary);
      color: var(--white);
      font-size: 10px;
      font-weight: 700;
      border-radius: var(--radius-full);
      text-transform: uppercase;
    }

    .menu-card-content {
      padding: var(--space-md);
    }

    .menu-card-name {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .menu-card-desc {
      font-size: 12px;
      color: var(--gray-500);
      margin-bottom: var(--space-sm);
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .menu-card-footer {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .menu-card-price {
      font-size: 16px;
      font-weight: 700;
      color: var(--brand-primary);
    }

    .add-btn {
      width: 32px;
      height: 32px;
      border-radius: var(--radius-full);
      background: var(--gray-900);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .add-btn:active {
      transform: scale(0.9);
      background: var(--brand-primary);
    }

    .add-btn svg {
      width: 16px;
      height: 16px;
      color: var(--white);
    }

    /* ========================================
       BOTTOM NAVIGATION
    ======================================== */

    .bottom-nav {
      position: fixed;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100%;
      max-width: 480px;
      background: var(--white);
      border-top: 1px solid var(--gray-100);
      padding: var(--space-sm) var(--space-md);
      padding-bottom: calc(var(--space-sm) + var(--safe-bottom, 8px));
      display: flex;
      justify-content: space-around;
      z-index: 1000;
    }

    .nav-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: var(--space-sm) var(--space-md);
      border: none;
      background: transparent;
      cursor: pointer;
      transition: all 0.2s ease;
      border-radius: var(--radius-md);
    }

    .nav-item svg {
      width: 24px;
      height: 24px;
      color: var(--gray-400);
      transition: all 0.2s ease;
    }

    .nav-item span {
      font-size: 11px;
      font-weight: 500;
      color: var(--gray-400);
      transition: all 0.2s ease;
    }

    .nav-item.active svg {
      color: var(--brand-primary);
    }

    .nav-item.active span {
      color: var(--brand-primary);
      font-weight: 600;
    }

    .nav-item:active {
      background: var(--gray-100);
    }

    /* Order Button */
    .nav-order {
      position: relative;
      top: -20px;
      width: 56px;
      height: 56px;
      border-radius: var(--radius-full);
      background: var(--brand-primary);
      border: 4px solid var(--white);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: var(--shadow-lg);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .nav-order svg {
      width: 24px;
      height: 24px;
      color: var(--white);
    }

    .nav-order:active {
      transform: scale(0.95);
    }

    .nav-order .order-badge {
      position: absolute;
      top: -4px;
      right: -4px;
      min-width: 20px;
      height: 20px;
      background: var(--gray-900);
      color: var(--white);
      font-size: 11px;
      font-weight: 700;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 6px;
      border: 2px solid var(--white);
    }

    /* ========================================
       MINI HEADER
    ======================================== */

    .mini-header {
      position: fixed;
      top: 0;
      left: 50%;
      transform: translateX(-50%) translateY(-100%);
      width: 100%;
      max-width: 480px;
      background: var(--white);
      padding: var(--space-sm) var(--space-lg);
      padding-top: calc(var(--safe-top, 44px) + var(--space-sm));
      display: flex;
      flex-direction: column;
      gap: var(--space-sm);
      z-index: 1000;
      box-shadow: var(--shadow-md);
      transition: transform 0.3s ease;
    }

    .mini-header.visible {
      transform: translateX(-50%) translateY(0);
    }

    .mini-header-top {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .mini-header-brand {
      display: flex;
      align-items: center;
      gap: var(--space-sm);
    }

    .mini-header-logo {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-sm);
      background: linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-dark) 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      font-weight: 700;
      font-size: 12px;
      background-size: cover;
      background-position: center;
    }

    .mini-header-name {
      font-size: 16px;
      font-weight: 700;
    }

    .mini-header-actions {
      display: flex;
      gap: var(--space-sm);
    }

    .mini-header-btn {
      width: 36px;
      height: 36px;
      border-radius: var(--radius-full);
      background: var(--gray-100);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      position: relative;
    }

    .mini-header-btn svg {
      width: 18px;
      height: 18px;
      color: var(--gray-700);
    }

    .mini-header-btn .badge {
      position: absolute;
      top: -4px;
      right: -4px;
      min-width: 18px;
      height: 18px;
      background: var(--brand-primary);
      color: var(--white);
      font-size: 10px;
      font-weight: 700;
      border-radius: var(--radius-full);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Section indicator inside mini header */
    .mini-header-section {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: var(--space-sm);
      padding: 6px var(--space-md);
      background: var(--gray-100);
      border-radius: var(--radius-full);
      opacity: 0;
      max-height: 0;
      overflow: hidden;
      transition: all 0.3s ease;
      margin-top: 0;
    }

    .mini-header-section.visible {
      opacity: 1;
      max-height: 40px;
      margin-top: var(--space-sm);
    }

    .mini-header-section .emoji {
      font-size: 14px;
    }

    .mini-header-section .text {
      font-size: 13px;
      font-weight: 600;
      color: var(--gray-700);
    }

    /* Section dots */
    .section-dots {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-left: auto;
    }

    .section-dot {
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: var(--gray-300);
      transition: all 0.3s ease;
    }

    .section-dot.active {
      width: 20px;
      border-radius: 3px;
      background: var(--brand-primary);
    }

    /* ========================================
       ANIMATIONS
    ======================================== */

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .hero-header-info {
      animation: fadeInUp 0.6s ease 0.2s forwards;
      opacity: 0;
    }

    .search-section {
      animation: fadeInUp 0.5s ease 0.3s forwards;
      opacity: 0;
    }

    .promo-banner {
      animation: fadeInUp 0.5s ease 0.4s forwards;
      opacity: 0;
    }

    .loyalty-card {
      animation: fadeInUp 0.5s ease 0.5s forwards;
      opacity: 0;
    }

    .menu-card {
      animation: fadeInUp 0.4s ease forwards;
      opacity: 0;
    }

    .menu-card:nth-child(1) { animation-delay: 0.5s; }
    .menu-card:nth-child(2) { animation-delay: 0.55s; }
    .menu-card:nth-child(3) { animation-delay: 0.6s; }
    .menu-card:nth-child(4) { animation-delay: 0.65s; }
  </style>
</head>
<body>
  <div class="app">

    <!-- ========================================
         HOME VIEW
    ======================================== -->
    <div class="app-view active" id="homeView">

      <!-- Mini Header - Appears when scrolled -->
      <div class="mini-header" id="miniHeader">
        <div class="mini-header-top">
          <div class="mini-header-brand">
            <div class="mini-header-logo" id="miniHeaderLogo">PR</div>
            <span class="mini-header-name" id="miniHeaderName">Pizzeria Roma</span>
          </div>
          <div class="mini-header-actions">
            <button class="mini-header-btn" onclick="switchView('searchView')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="M21 21l-4.35-4.35"/>
              </svg>
            </button>
            <button class="mini-header-btn" onclick="switchView('cartView')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
                <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
              </svg>
              <span class="badge" id="miniCartBadge">0</span>
            </button>
          </div>
        </div>
        <!-- Section indicator in header -->
        <div class="mini-header-section" id="miniHeaderSection">
          <span class="emoji" id="miniSectionEmoji">üçï</span>
          <span class="text" id="miniSectionName">Pizza</span>
          <div class="section-dots" id="sectionDots">
            <span class="section-dot" data-section="tilbud"></span>
            <span class="section-dot" data-section="loyalty"></span>
            <span class="section-dot" data-section="pizza"></span>
            <span class="section-dot" data-section="salater"></span>
            <span class="section-dot" data-section="pasta"></span>
            <span class="section-dot" data-section="dessert"></span>
          </div>
        </div>
      </div>

      <!-- Hero Header with Image -->
      <header class="hero-header" id="heroHeader">
        <!-- Restaurant Header Image - Placeholder gradient if no image -->
        <div class="hero-header-placeholder" id="heroPlaceholder">üçï</div>
        <img
          src=""
          alt="Restaurant header"
          class="hero-header-image"
          id="heroHeaderImage"
          style="display: none;"
          onerror="this.style.display='none'; document.getElementById('heroPlaceholder').style.display='flex';"
        >

        <!-- Gradient overlay for text readability -->
        <div class="hero-header-overlay"></div>

        <!-- Top navigation buttons -->
        <nav class="hero-header-nav">
          <button class="header-btn" style="visibility: hidden;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <div class="header-btn-group">
            <button class="header-btn" onclick="switchView('searchView')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="M21 21l-4.35-4.35"/>
              </svg>
            </button>
            <button class="header-btn has-badge" onclick="switchView('cartView')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
                <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
              </svg>
              <span class="badge" id="headerCartBadge">0</span>
            </button>
          </div>
        </nav>

        <!-- Restaurant info at bottom of hero -->
        <div class="hero-header-info">
          <div class="restaurant-badge">
            <span class="dot"></span>
            <span>√Öben nu</span>
          </div>
          <h1 class="restaurant-name" id="restaurantName">Pizzeria Roma</h1>
          <p class="restaurant-tagline" id="restaurantTagline">Autentisk italiensk pizza siden 1985</p>
        </div>
      </header>

      <!-- Scrollable content area -->
      <main class="app-content" id="appContent">
        <div class="content-wrapper">

          <!-- Search Bar -->
          <div class="search-section" data-section="search">
            <div class="search-bar" onclick="switchView('searchView')">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="11" cy="11" r="8"/>
                <path d="M21 21l-4.35-4.35"/>
              </svg>
              <input type="text" placeholder="S√∏g i menuen..." readonly>
            </div>
          </div>

          <!-- Quick Info Row -->
          <div class="quick-info">
            <div class="quick-info-item highlight">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
              4.8 (324)
            </div>
            <div class="quick-info-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="M12 6v6l4 2"/>
              </svg>
              20-30 min
            </div>
            <div class="quick-info-item">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/>
                <circle cx="12" cy="10" r="3"/>
              </svg>
              1.2 km
            </div>
            <div class="quick-info-item">
              Min. 75 kr
            </div>
          </div>

          <!-- Promo Banner -->
          <div class="promo-banner" data-section="tilbud" onclick="switchView('offersView')" style="cursor: pointer;">
            <div class="promo-content">
              <div class="promo-label">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
                </svg>
                Dagens tilbud
              </div>
              <h3 class="promo-title">2 pizzaer for 149 kr.</h3>
              <p class="promo-subtitle">G√¶lder alle hverdage mellem 15-18</p>
            </div>
          </div>

          <!-- Loyalty Card -->
          <div class="loyalty-card" data-section="loyalty" onclick="switchView('pointsView')" style="cursor: pointer;">
            <div class="loyalty-header">
              <span class="loyalty-label">Dine point</span>
              <div class="loyalty-points">
                <span class="loyalty-points-value">847</span>
                <span class="loyalty-points-label">point</span>
              </div>
            </div>
            <div class="loyalty-progress">
              <div class="loyalty-progress-bar">
                <div class="loyalty-progress-fill" style="width: 84.7%;"></div>
              </div>
              <div class="loyalty-progress-text">
                <span>153 point til gratis pizza</span>
                <span>1000 point</span>
              </div>
            </div>
          </div>

          <!-- Categories -->
          <div class="categories">
            <div class="categories-scroll">
              <button class="category-chip active" data-category="all">Alle</button>
              <button class="category-chip" data-category="pizza">üçï Pizza</button>
              <button class="category-chip" data-category="salater">ü•ó Salater</button>
              <button class="category-chip" data-category="pasta">üçù Pasta</button>
              <button class="category-chip" data-category="dessert">üç∞ Dessert</button>
              <button class="category-chip" data-category="drikkevarer">ü•§ Drikkevarer</button>
            </div>
          </div>

          <!-- Pizza Section -->
          <section class="section" data-section="pizza">
            <div class="section-header">
              <h2 class="section-title">üçï Pizza</h2>
              <a href="#" class="section-link">Se alle</a>
            </div>
            <div class="menu-grid">
              <div class="menu-card" onclick="openProductModal({name: 'Margherita', desc: 'Tomatsauce, mozzarella, frisk basilikum', price: 89, emoji: 'üçï', badge: 'Bestseller', category: 'pizza', ingredients: ['Tomatsauce', 'Mozzarella', 'Basilikum', 'Olivenolie']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #FED7AA 0%, #FDBA74 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üçï
                  <span class="menu-card-badge">Bestseller</span>
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Margherita</h3>
                  <p class="menu-card-desc">Tomatsauce, mozzarella, frisk basilikum</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">89 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Margherita', price: 89, emoji: 'üçï'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <div class="menu-card" onclick="openProductModal({name: 'Pepperoni', desc: 'Tomatsauce, mozzarella, pepperoni', price: 109, emoji: 'üçï', category: 'pizza', ingredients: ['Tomatsauce', 'Mozzarella', 'Pepperoni']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #FECACA 0%, #F87171 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üçï
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Pepperoni</h3>
                  <p class="menu-card-desc">Tomatsauce, mozzarella, pepperoni</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">109 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Pepperoni', price: 109, emoji: 'üçï'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <div class="menu-card" onclick="openProductModal({name: 'Quattro Formaggi', desc: 'Fire slags ost, hvidl√∏g', price: 119, emoji: 'üßÄ', category: 'pizza', ingredients: ['Mozzarella', 'Gorgonzola', 'Parmesan', 'Fontina', 'Hvidl√∏g']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #DDD6FE 0%, #A78BFA 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üßÄ
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Quattro Formaggi</h3>
                  <p class="menu-card-desc">Fire slags ost, hvidl√∏g</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">119 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Quattro Formaggi', price: 119, emoji: 'üßÄ'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <div class="menu-card" onclick="openProductModal({name: 'Vegetar', desc: 'Gr√∏ntsager, mozzarella, oliven', price: 99, emoji: 'ü•¨', category: 'pizza', ingredients: ['Tomatsauce', 'Mozzarella', 'Paprika', 'L√∏g', 'Oliven', 'Champignon']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #BBF7D0 0%, #4ADE80 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  ü•¨
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Vegetar</h3>
                  <p class="menu-card-desc">Gr√∏ntsager, mozzarella, oliven</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">99 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Vegetar', price: 99, emoji: 'ü•¨'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Salater Section -->
          <section class="section" data-section="salater">
            <div class="section-header">
              <h2 class="section-title">ü•ó Salater</h2>
              <a href="#" class="section-link">Se alle</a>
            </div>
            <div class="menu-grid">
              <div class="menu-card" onclick="openProductModal({name: 'Caesar Salat', desc: 'Romaine, kylling, parmesan, croutoner', price: 89, emoji: 'ü•ó', category: 'salater', ingredients: ['Romaine salat', 'Kylling', 'Parmesan', 'Croutoner', 'Caesar dressing']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #D1FAE5 0%, #6EE7B7 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  ü•ó
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Caesar Salat</h3>
                  <p class="menu-card-desc">Romaine, kylling, parmesan, croutoner</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">89 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Caesar Salat', price: 89, emoji: 'ü•ó'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <div class="menu-card" onclick="openProductModal({name: 'Gr√¶sk Salat', desc: 'Tomat, agurk, feta, oliven', price: 79, emoji: 'ü•ó', category: 'salater', ingredients: ['Tomat', 'Agurk', 'Feta', 'Oliven', 'R√∏dl√∏g', 'Oregano']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #CFFAFE 0%, #67E8F9 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  ü•ó
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Gr√¶sk Salat</h3>
                  <p class="menu-card-desc">Tomat, agurk, feta, oliven</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">79 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Gr√¶sk Salat', price: 79, emoji: 'ü•ó'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Pasta Section -->
          <section class="section" data-section="pasta">
            <div class="section-header">
              <h2 class="section-title">üçù Pasta</h2>
              <a href="#" class="section-link">Se alle</a>
            </div>
            <div class="menu-grid">
              <div class="menu-card" onclick="openProductModal({name: 'Spaghetti Carbonara', desc: 'Bacon, √¶g, parmesan, fl√∏de', price: 99, emoji: 'üçù', category: 'pasta', ingredients: ['Spaghetti', 'Bacon', '√Üg', 'Parmesan', 'Fl√∏de', 'Peber']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #FEF3C7 0%, #FCD34D 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üçù
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Spaghetti Carbonara</h3>
                  <p class="menu-card-desc">Bacon, √¶g, parmesan, fl√∏de</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">99 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Spaghetti Carbonara', price: 99, emoji: 'üçù'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <div class="menu-card" onclick="openProductModal({name: 'Lasagne', desc: 'K√∏dsauce, bechamel, ost', price: 109, emoji: 'üçù', category: 'pasta', ingredients: ['Pastaplader', 'K√∏dsauce', 'Bechamel', 'Mozzarella', 'Parmesan']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #FECDD3 0%, #FB7185 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üçù
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Lasagne</h3>
                  <p class="menu-card-desc">K√∏dsauce, bechamel, ost</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">109 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Lasagne', price: 109, emoji: 'üçù'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

          <!-- Dessert Section -->
          <section class="section" data-section="dessert">
            <div class="section-header">
              <h2 class="section-title">üç∞ Dessert</h2>
              <a href="#" class="section-link">Se alle</a>
            </div>
            <div class="menu-grid">
              <div class="menu-card" onclick="openProductModal({name: 'Tiramisu', desc: 'Mascarpone, kaffe, kakao', price: 59, emoji: 'üç∞', category: 'dessert', ingredients: ['Mascarpone', 'Ladyfingers', 'Espresso', 'Kakao', 'Amaretto']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #F5D0FE 0%, #E879F9 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üç∞
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Tiramisu</h3>
                  <p class="menu-card-desc">Mascarpone, kaffe, kakao</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">59 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Tiramisu', price: 59, emoji: 'üç∞'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>

              <div class="menu-card" onclick="openProductModal({name: 'Panna Cotta', desc: 'Vanille, jordb√¶rcoulis', price: 49, emoji: 'üçÆ', category: 'dessert', ingredients: ['Fl√∏de', 'Vanille', 'Gelatine', 'Jordb√¶r']})">
                <div class="menu-card-image" style="background: linear-gradient(135deg, #FED7E2 0%, #F472B6 100%); display: flex; align-items: center; justify-content: center; font-size: 50px;">
                  üçÆ
                </div>
                <div class="menu-card-content">
                  <h3 class="menu-card-name">Panna Cotta</h3>
                  <p class="menu-card-desc">Vanille, jordb√¶rcoulis</p>
                  <div class="menu-card-footer">
                    <span class="menu-card-price">49 kr.</span>
                    <button class="add-btn" onclick="event.stopPropagation(); addToCart({name: 'Panna Cotta', price: 49, emoji: 'üçÆ'})">
                      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                        <path d="M12 5v14M5 12h14"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>
      </main>

    </div>

    <!-- ========================================
         SEARCH VIEW
    ======================================== -->
    <div class="app-view" id="searchView">
      <div class="search-view">
        <div class="search-view-header">
          <button class="search-view-back" onclick="switchView('homeView')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <input type="text" class="search-view-input" placeholder="S√∏g efter retter..." autofocus>
        </div>

        <div class="search-recent">
          <h3 class="search-section-title">Seneste s√∏gninger</h3>
          <div class="search-recent-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            <span>Margherita</span>
          </div>
          <div class="search-recent-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            <span>Carbonara</span>
          </div>
          <div class="search-recent-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <polyline points="12 6 12 12 16 14"/>
            </svg>
            <span>Tiramisu</span>
          </div>
        </div>

        <div>
          <h3 class="search-section-title">Popul√¶re s√∏gninger</h3>
          <div class="search-popular-tags">
            <span class="search-tag">üçï Pizza</span>
            <span class="search-tag">üçù Pasta</span>
            <span class="search-tag">ü•ó Salat</span>
            <span class="search-tag">üç∞ Dessert</span>
            <span class="search-tag">üßÄ Ost</span>
            <span class="search-tag">üå∂Ô∏è Krydret</span>
          </div>
        </div>
      </div>
    </div>

    <!-- ========================================
         POINTS VIEW
    ======================================== -->
    <div class="app-view" id="pointsView">
      <div class="points-view">
        <div class="points-header">
          <div class="points-value-large">847</div>
          <div class="points-label">point optjent</div>
          <div class="points-progress-large">
            <div class="points-progress-large-fill" style="width: 84.7%"></div>
          </div>
          <div class="points-progress-text">153 point til gratis pizza</div>
        </div>

        <div class="points-content">
          <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Tilg√¶ngelige bel√∏nninger</h3>
          <div class="rewards-grid" id="rewardsGrid">
            <!-- Rewards will be rendered by JavaScript -->
          </div>

          <h3 style="font-size: 16px; font-weight: 600; margin-bottom: 16px;">Point historik</h3>
          <div class="points-history" id="pointsHistoryList">
            <!-- History will be rendered by JavaScript -->
          </div>
        </div>
      </div>
    </div>

    <!-- ========================================
         PROFILE VIEW
    ======================================== -->
    <div class="app-view" id="profileView">
      <div class="profile-view">
        <div class="profile-header">
          <div class="profile-avatar">JD</div>
          <h2 class="profile-name">John Doe</h2>
          <p class="profile-email">john.doe@example.com</p>
          <div class="profile-stats">
            <div class="profile-stat">
              <div class="profile-stat-value">847</div>
              <div class="profile-stat-label">Point</div>
            </div>
            <div class="profile-stat">
              <div class="profile-stat-value">23</div>
              <div class="profile-stat-label">Ordrer</div>
            </div>
          </div>
        </div>

        <div class="profile-menu">
          <div class="profile-menu-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M16 21v-2a4 4 0 00-4-4H6a4 4 0 00-4 4v2"/>
              <circle cx="9" cy="7" r="4"/>
              <path d="M22 21v-2a4 4 0 00-3-3.87M16 3.13a4 4 0 010 7.75"/>
            </svg>
            <span>Mine oplysninger</span>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </div>
          <div class="profile-menu-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/>
              <line x1="1" y1="10" x2="23" y2="10"/>
            </svg>
            <span>Betalingsmetoder</span>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </div>
          <div class="profile-menu-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/>
              <circle cx="12" cy="10" r="3"/>
            </svg>
            <span>Leveringsadresser</span>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </div>
          <div class="profile-menu-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9"/>
              <path d="M13.73 21a2 2 0 01-3.46 0"/>
            </svg>
            <span>Notifikationer</span>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </div>
          <div class="profile-menu-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
            </svg>
            <span>Indstillinger</span>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </div>
          <div class="profile-menu-item danger">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
              <polyline points="16 17 21 12 16 7"/>
              <line x1="21" y1="12" x2="9" y2="12"/>
            </svg>
            <span>Log ud</span>
            <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="9 18 15 12 9 6"/>
            </svg>
          </div>
        </div>
      </div>
    </div>

    <!-- ========================================
         CART VIEW
    ======================================== -->
    <div class="app-view" id="cartView">
      <div class="cart-view">
        <div class="cart-header">
          <button class="cart-back" onclick="switchView('homeView')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <h2>Din kurv</h2>
          <button class="cart-clear" onclick="clearCart()">Ryd</button>
        </div>

        <div class="cart-items" id="cartItems">
          <!-- Cart items will be rendered here by JavaScript -->
        </div>

        <div class="cart-empty" id="cartEmpty" style="display: none;">
          <div class="cart-empty-icon">üõí</div>
          <h3>Din kurv er tom</h3>
          <p>Tilf√∏j l√¶kre retter fra menuen</p>
        </div>

        <div class="cart-footer" id="cartFooter">
          <div class="cart-subtotal">
            <span>Subtotal</span>
            <span id="cartSubtotal">0 kr.</span>
          </div>
          <div class="cart-subtotal">
            <span>Levering</span>
            <span>29 kr.</span>
          </div>
          <div class="cart-total">
            <span>Total</span>
            <span id="cartTotal">29 kr.</span>
          </div>
          <button class="cart-checkout">G√• til betaling</button>
        </div>
      </div>
    </div>

    <!-- ========================================
         OFFERS VIEW
    ======================================== -->
    <div class="app-view" id="offersView">
      <div class="offers-view">
        <div class="offers-header">
          <button class="offers-back" onclick="switchView('homeView')">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
          </button>
          <h2>Tilbud</h2>
          <div style="width: 40px;"></div>
        </div>

        <div class="offers-content" id="offersContent">
          <!-- Offer cards will be rendered here -->
        </div>
      </div>
    </div>

    <!-- ========================================
         BOTTOM NAVIGATION
    ======================================== -->
    <nav class="bottom-nav" id="bottomNav">
      <button class="nav-item active" data-view="homeView" onclick="switchView('homeView')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 01-2 2H5a2 2 0 01-2-2z"/>
          <polyline points="9 22 9 12 15 12 15 22"/>
        </svg>
        <span>Hjem</span>
      </button>
      <button class="nav-item" data-view="searchView" onclick="switchView('searchView')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="11" cy="11" r="8"/>
          <path d="M21 21l-4.35-4.35"/>
        </svg>
        <span>S√∏g</span>
      </button>
      <button class="nav-order" onclick="switchView('cartView')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
          <circle cx="9" cy="21" r="1"/>
          <circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
        </svg>
        <span class="order-badge" id="navCartBadge">0</span>
      </button>
      <button class="nav-item" data-view="pointsView" onclick="switchView('pointsView')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
        </svg>
        <span>Point</span>
      </button>
      <button class="nav-item" data-view="profileView" onclick="switchView('profileView')">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M20 21v-2a4 4 0 00-4-4H8a4 4 0 00-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
        <span>Profil</span>
      </button>
    </nav>

    <!-- ========================================
         PRODUCT MODAL
    ======================================== -->
    <div class="product-modal-overlay" id="productModal">
      <div class="product-modal">
        <div class="product-modal-image">
          <div class="product-modal-image-placeholder" id="productModalEmoji">üçï</div>
          <button class="product-modal-close" onclick="closeProductModal()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"/>
              <line x1="6" y1="6" x2="18" y2="18"/>
            </svg>
          </button>
          <span class="product-modal-badge" id="productModalBadge" style="display: none;">Bestseller</span>
        </div>
        <div class="product-modal-content">
          <div class="product-modal-header">
            <h2 class="product-modal-name" id="productModalName">Margherita</h2>
            <span class="product-modal-price" id="productModalPrice">89 kr.</span>
          </div>
          <p class="product-modal-desc" id="productModalDesc">Tomatsauce, mozzarella, frisk basilikum</p>

          <div class="product-modal-section">
            <h3 class="product-modal-section-title">Ingredienser (tryk for at frav√¶lge)</h3>
            <div class="product-modal-ingredients" id="productModalIngredients">
              <span class="ingredient-tag">Tomatsauce</span>
              <span class="ingredient-tag">Mozzarella</span>
              <span class="ingredient-tag">Basilikum</span>
            </div>
          </div>

          <div class="product-modal-section" id="extrasSection">
            <h3 class="product-modal-section-title">Tilbeh√∏r</h3>
            <div class="product-modal-extras" id="productModalExtras">
              <!-- Extras will be rendered by JavaScript -->
            </div>
          </div>

          <div class="quantity-selector">
            <label>Antal</label>
            <div class="quantity-controls">
              <button class="quantity-btn" onclick="changeModalQuantity(-1)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
              </button>
              <span class="quantity-value" id="modalQuantity">1</span>
              <button class="quantity-btn" onclick="changeModalQuantity(1)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <line x1="12" y1="5" x2="12" y2="19"/>
                  <line x1="5" y1="12" x2="19" y2="12"/>
                </svg>
              </button>
            </div>
          </div>

          <button class="add-to-cart-btn" onclick="addFromModal()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
              <path d="M1 1h4l2.68 13.39a2 2 0 002 1.61h9.72a2 2 0 002-1.61L23 6H6"/>
            </svg>
            <span id="addToCartBtnText">Tilf√∏j til kurv - 89 kr.</span>
          </button>
        </div>
      </div>
    </div>

    <!-- ========================================
         REDEEM CONFIRMATION MODAL
    ======================================== -->
    <div class="redeem-modal-overlay" id="redeemModal">
      <div class="redeem-modal">
        <button class="redeem-modal-close" onclick="closeRedeemModal()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
        <div class="redeem-modal-emoji" id="redeemRewardEmoji">üçï</div>
        <h2 class="redeem-modal-title" id="redeemRewardName">Gratis Pizza</h2>
        <p class="redeem-modal-desc" id="redeemRewardDesc">V√¶lg en pizza fra menuen</p>
        <div class="redeem-modal-cost">
          <span>Pris:</span>
          <span id="redeemRewardCost">1000 point</span>
        </div>
        <div class="redeem-modal-after">
          <span>Point efter indl√∏sning:</span>
          <span id="redeemPointsAfter">0 point</span>
        </div>
        <div class="redeem-modal-buttons">
          <button class="redeem-cancel-btn" onclick="closeRedeemModal()">Annuller</button>
          <button class="redeem-confirm-btn" onclick="confirmRedeem()">Indl√∏s nu</button>
        </div>
      </div>
    </div>

    <!-- ========================================
         HISTORY DETAIL MODAL
    ======================================== -->
    <div class="history-detail-modal-overlay" id="historyDetailModal">
      <div class="history-detail-modal">
        <button class="history-detail-close" onclick="closeHistoryDetail()">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
        <div id="historyDetailContent">
          <!-- Content will be rendered by JavaScript -->
        </div>
      </div>
    </div>

  </div>

  <script>
    // ========================================
    // CART STATE
    // ========================================
    let cart = [];
    let currentProduct = null;
    let modalQuantity = 1;
    let modalRemovedIngredients = [];
    let modalSelectedExtras = [];

    // ========================================
    // CATEGORY EXTRAS DATA
    // ========================================
    const categoryExtras = {
      pizza: [
        { name: 'Ekstra ost', price: 10 },
        { name: 'Bacon', price: 15 },
        { name: 'Champignon', price: 10 },
        { name: 'Pepperoni', price: 15 },
        { name: 'Oliven', price: 10 },
        { name: 'Jalapenos', price: 10 },
        { name: 'Skinke', price: 15 }
      ],
      salater: [
        { name: 'Ekstra kylling', price: 20 },
        { name: 'Ekstra feta', price: 15 },
        { name: 'Croutoner', price: 10 },
        { name: 'Ekstra dressing', price: 5 }
      ],
      pasta: [
        { name: 'Ekstra k√∏d', price: 20 },
        { name: 'Ekstra ost', price: 15 },
        { name: 'Hvidl√∏gsbr√∏d', price: 15 }
      ],
      dessert: [
        { name: 'Ekstra fl√∏deskum', price: 10 },
        { name: 'Chokoladesauce', price: 10 },
        { name: 'Is kugle', price: 15 }
      ]
    };

    // ========================================
    // POINTS & REWARDS DATA
    // ========================================
    let userPoints = 847;

    const rewards = [
      { id: 1, name: 'Gratis Pizza', emoji: 'üçï', cost: 1000, description: 'V√¶lg en pizza fra menuen' },
      { id: 2, name: 'Gratis Sodavand', emoji: 'ü•§', cost: 250, description: '33cl sodavand valgfrit' },
      { id: 3, name: 'Gratis Dessert', emoji: 'üç∞', cost: 500, description: 'V√¶lg en dessert fra menuen' },
      { id: 4, name: 'VIP Status', emoji: 'üéâ', cost: 5000, description: 'Dobbelt point i 3 m√•neder' }
    ];

    const pointsHistory = [
      { id: 1234, date: 'I g√•r, 19:30', points: 47, type: 'earned', items: ['Margherita', 'Cola'] },
      { id: 1233, date: '3 dage siden', points: 85, type: 'earned', items: ['Pepperoni', 'Tiramisu'] },
      { id: null, date: '1 uge siden', points: -250, type: 'redeemed', reward: 'Gratis Sodavand' },
      { id: 1230, date: '2 uger siden', points: 120, type: 'earned', items: ['Quattro Formaggi', 'Caesar Salat', 'Panna Cotta'] },
      { id: 1225, date: '3 uger siden', points: 65, type: 'earned', items: ['Vegetar Pizza'] }
    ];

    // ========================================
    // OFFERS DATA
    // ========================================
    const offers = [
      {
        id: 1,
        title: '2 pizzaer for 149 kr.',
        subtitle: 'Spar 29 kr.',
        description: 'V√¶lg 2 valgfrie pizzaer fra menuen',
        conditions: 'G√¶lder alle hverdage mellem 15-18',
        originalPrice: 178,
        salePrice: 149,
        emoji: 'üçï'
      },
      {
        id: 2,
        title: 'Familiemenu',
        subtitle: 'Spar 50 kr.',
        description: '2 pizzaer + 2 sodavand + 1 dessert',
        conditions: 'G√¶lder hele ugen',
        originalPrice: 299,
        salePrice: 249,
        emoji: 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶'
      },
      {
        id: 3,
        title: 'Frokosttilbud',
        subtitle: 'Kun 69 kr.',
        description: 'Pizza slice + sodavand',
        conditions: 'Hverdage 11-14',
        originalPrice: 89,
        salePrice: 69,
        emoji: 'üåû'
      }
    ];

    // ========================================
    // VIEW SWITCHING
    // ========================================
    function switchView(viewId) {
      // Hide all views
      document.querySelectorAll('.app-view').forEach(view => {
        view.classList.remove('active');
      });

      // Show selected view
      const selectedView = document.getElementById(viewId);
      if (selectedView) {
        selectedView.classList.add('active');
      }

      // Update nav items
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.view === viewId) {
          item.classList.add('active');
        }
      });

      // Show/hide bottom nav for cart and offers view
      const bottomNav = document.getElementById('bottomNav');
      if (viewId === 'cartView' || viewId === 'offersView') {
        bottomNav.style.display = 'none';
      } else {
        bottomNav.style.display = 'flex';
      }

      // Show/hide mini header for non-home views
      const miniHeader = document.getElementById('miniHeader');
      if (viewId !== 'homeView') {
        miniHeader.classList.remove('visible');
      }

      // Reset scroll state when switching to homeView
      if (viewId === 'homeView') {
        setTimeout(() => {
          initializeScrollState();
        }, 50);
      }
    }

    // ========================================
    // SCROLL HANDLING
    // ========================================
    const appContent = document.getElementById('appContent');
    const miniHeader = document.getElementById('miniHeader');
    const miniHeaderSection = document.getElementById('miniHeaderSection');
    const heroHeader = document.getElementById('heroHeader');

    let lastScrollTop = 0;
    let scrollThreshold = 200;

    if (appContent) {
      appContent.addEventListener('scroll', function() {
        const scrollTop = this.scrollTop;

        // Show/hide mini header based on scroll
        if (scrollTop > scrollThreshold) {
          miniHeader.classList.add('visible');
          miniHeaderSection.classList.add('visible');
        } else {
          miniHeader.classList.remove('visible');
          miniHeaderSection.classList.remove('visible');
        }

        // Fade and collapse hero header
        const fadeStart = 0;
        const fadeEnd = 200;
        const opacity = Math.max(0, 1 - (scrollTop - fadeStart) / (fadeEnd - fadeStart));
        heroHeader.style.opacity = opacity;

        // Collapse hero header height as we scroll
        const headerHeight = 280;
        const minHeight = 0;
        const newHeight = Math.max(minHeight, headerHeight - scrollTop * 0.8);
        heroHeader.style.height = newHeight + 'px';
        heroHeader.style.minHeight = newHeight + 'px';

        // Update section indicator
        updateSectionIndicator();

        lastScrollTop = scrollTop;
      });
    }

    // ========================================
    // SECTION INDICATOR
    // ========================================
    const sections = {
      'tilbud': { emoji: '‚≠ê', name: 'Tilbud' },
      'loyalty': { emoji: 'üéÅ', name: 'Point' },
      'pizza': { emoji: 'üçï', name: 'Pizza' },
      'salater': { emoji: 'ü•ó', name: 'Salater' },
      'pasta': { emoji: 'üçù', name: 'Pasta' },
      'dessert': { emoji: 'üç∞', name: 'Dessert' }
    };

    function updateSectionIndicator() {
      const scrollTop = appContent.scrollTop;
      const sectionElements = document.querySelectorAll('[data-section]');
      let currentSection = null;

      sectionElements.forEach(el => {
        const rect = el.getBoundingClientRect();
        const appRect = appContent.getBoundingClientRect();
        if (rect.top <= appRect.top + 150) {
          currentSection = el.dataset.section;
        }
      });

      if (currentSection && sections[currentSection]) {
        document.getElementById('miniSectionEmoji').textContent = sections[currentSection].emoji;
        document.getElementById('miniSectionName').textContent = sections[currentSection].name;

        // Update dots
        document.querySelectorAll('.section-dot').forEach(dot => {
          dot.classList.remove('active');
          if (dot.dataset.section === currentSection) {
            dot.classList.add('active');
          }
        });
      }
    }

    // ========================================
    // CATEGORY SELECTION
    // ========================================
    document.querySelectorAll('.category-chip').forEach(chip => {
      chip.addEventListener('click', function() {
        document.querySelectorAll('.category-chip').forEach(c => c.classList.remove('active'));
        this.classList.add('active');

        const category = this.dataset.category;
        // TODO: Filter menu items by category
      });
    });

    // ========================================
    // CART FUNCTIONS
    // ========================================
    function addToCart(item) {
      // Check for existing item with same name AND same customizations
      const existingItem = cart.find(i => {
        if (i.name !== item.name) return false;

        // Compare removed ingredients
        const removed1 = (i.removedIngredients || []).sort().join(',');
        const removed2 = (item.removedIngredients || []).sort().join(',');
        if (removed1 !== removed2) return false;

        // Compare extras
        const extras1 = (i.extras || []).map(e => e.name).sort().join(',');
        const extras2 = (item.extras || []).map(e => e.name).sort().join(',');
        if (extras1 !== extras2) return false;

        return true;
      });

      if (existingItem) {
        existingItem.qty++;
      } else {
        cart.push({ ...item, qty: 1 });
      }
      updateCartUI();

      // Animate badge
      animateCartBadge();
    }

    function removeFromCart(index) {
      cart.splice(index, 1);
      updateCartUI();
    }

    function updateItemQty(index, delta) {
      cart[index].qty += delta;
      if (cart[index].qty <= 0) {
        removeFromCart(index);
      } else {
        updateCartUI();
      }
    }

    function clearCart() {
      cart = [];
      updateCartUI();
    }

    function updateCartUI() {
      const totalItems = cart.reduce((sum, item) => sum + item.qty, 0);
      const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
      const delivery = 29;
      const total = subtotal + delivery;

      // Update badges
      document.getElementById('headerCartBadge').textContent = totalItems;
      document.getElementById('miniCartBadge').textContent = totalItems;
      document.getElementById('navCartBadge').textContent = totalItems;

      // Update cart totals
      document.getElementById('cartSubtotal').textContent = subtotal + ' kr.';
      document.getElementById('cartTotal').textContent = total + ' kr.';

      // Render cart items
      const cartItemsEl = document.getElementById('cartItems');
      const cartEmptyEl = document.getElementById('cartEmpty');
      const cartFooterEl = document.getElementById('cartFooter');

      if (cart.length === 0) {
        cartItemsEl.innerHTML = '';
        cartEmptyEl.style.display = 'flex';
        cartFooterEl.style.display = 'none';
      } else {
        cartEmptyEl.style.display = 'none';
        cartFooterEl.style.display = 'block';

        cartItemsEl.innerHTML = cart.map((item, index) => {
          // Build customizations text
          let customizations = '';
          if (item.removedIngredients && item.removedIngredients.length > 0) {
            customizations += `<div class="cart-item-customization removed">Uden: ${item.removedIngredients.join(', ')}</div>`;
          }
          if (item.extras && item.extras.length > 0) {
            customizations += `<div class="cart-item-customization added">+ ${item.extras.map(e => e.name).join(', ')}</div>`;
          }

          return `
            <div class="cart-item">
              <div class="cart-item-image" style="background: linear-gradient(135deg, #FED7AA 0%, #FDBA74 100%);">
                ${item.emoji || 'üçï'}
              </div>
              <div class="cart-item-info">
                <h3 class="cart-item-name">${item.name}</h3>
                ${customizations}
                <p class="cart-item-price">${item.price} kr.</p>
                <div class="cart-item-qty">
                  <button onclick="updateItemQty(${index}, -1)">-</button>
                  <span>${item.qty}</span>
                  <button onclick="updateItemQty(${index}, 1)">+</button>
                </div>
              </div>
            </div>
          `;
        }).join('');
      }
    }

    function animateCartBadge() {
      const badges = document.querySelectorAll('.badge, .order-badge');
      badges.forEach(badge => {
        badge.style.animation = 'pulse 0.3s ease';
        setTimeout(() => {
          badge.style.animation = '';
        }, 300);
      });
    }

    // ========================================
    // PRODUCT MODAL
    // ========================================
    function openProductModal(product) {
      currentProduct = product;
      modalQuantity = 1;
      modalRemovedIngredients = [];
      modalSelectedExtras = [];

      document.getElementById('productModalName').textContent = product.name;
      document.getElementById('productModalPrice').textContent = product.price + ' kr.';
      document.getElementById('productModalDesc').textContent = product.desc;
      document.getElementById('productModalEmoji').textContent = product.emoji || 'üçï';
      document.getElementById('modalQuantity').textContent = modalQuantity;

      // Badge
      const badge = document.getElementById('productModalBadge');
      if (product.badge) {
        badge.textContent = product.badge;
        badge.style.display = 'block';
      } else {
        badge.style.display = 'none';
      }

      // Toggleable Ingredients
      const ingredientsEl = document.getElementById('productModalIngredients');
      if (product.ingredients && product.ingredients.length > 0) {
        ingredientsEl.innerHTML = product.ingredients.map(ing =>
          `<span class="ingredient-tag toggleable" onclick="toggleIngredient('${ing}')">
            <span class="ingredient-check">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                <polyline points="20 6 9 17 4 12"/>
              </svg>
            </span>
            ${ing}
          </span>`
        ).join('');
      }

      // Extras section
      const extrasEl = document.getElementById('productModalExtras');
      const extrasSection = document.getElementById('extrasSection');
      const extras = categoryExtras[product.category] || [];
      if (extras.length > 0) {
        extrasEl.innerHTML = extras.map(extra =>
          `<div class="extra-item" onclick="toggleExtra('${extra.name}', ${extra.price})">
            <div class="extra-item-left">
              <span class="extra-checkbox">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                  <polyline points="20 6 9 17 4 12"/>
                </svg>
              </span>
              <span class="extra-name">${extra.name}</span>
            </div>
            <span class="extra-price">+${extra.price} kr.</span>
          </div>`
        ).join('');
        extrasSection.style.display = 'block';
      } else {
        extrasSection.style.display = 'none';
      }

      updateModalPrice();
      document.getElementById('productModal').classList.add('visible');
      document.body.style.overflow = 'hidden';
    }

    function toggleIngredient(ingredient) {
      const index = modalRemovedIngredients.indexOf(ingredient);
      if (index > -1) {
        modalRemovedIngredients.splice(index, 1);
      } else {
        modalRemovedIngredients.push(ingredient);
      }

      // Update UI
      const ingredientTags = document.querySelectorAll('.ingredient-tag.toggleable');
      ingredientTags.forEach(tag => {
        const tagName = tag.textContent.trim();
        if (modalRemovedIngredients.includes(tagName)) {
          tag.classList.add('removed');
        } else {
          tag.classList.remove('removed');
        }
      });
    }

    function toggleExtra(extraName, extraPrice) {
      const existingIndex = modalSelectedExtras.findIndex(e => e.name === extraName);
      if (existingIndex > -1) {
        modalSelectedExtras.splice(existingIndex, 1);
      } else {
        modalSelectedExtras.push({ name: extraName, price: extraPrice });
      }

      // Update UI
      const extraItems = document.querySelectorAll('.extra-item');
      extraItems.forEach(item => {
        const itemName = item.querySelector('.extra-name').textContent;
        if (modalSelectedExtras.some(e => e.name === itemName)) {
          item.classList.add('selected');
        } else {
          item.classList.remove('selected');
        }
      });

      updateModalPrice();
    }

    function updateModalPrice() {
      if (!currentProduct) return;

      const extrasTotal = modalSelectedExtras.reduce((sum, e) => sum + e.price, 0);
      const itemPrice = currentProduct.price + extrasTotal;
      const total = itemPrice * modalQuantity;

      document.getElementById('addToCartBtnText').textContent = `Tilf√∏j til kurv - ${total} kr.`;
    }

    function closeProductModal() {
      document.getElementById('productModal').classList.remove('visible');
      document.body.style.overflow = '';
      currentProduct = null;
      modalQuantity = 1;
      modalRemovedIngredients = [];
      modalSelectedExtras = [];
    }

    function changeModalQuantity(delta) {
      modalQuantity = Math.max(1, modalQuantity + delta);
      document.getElementById('modalQuantity').textContent = modalQuantity;

      if (currentProduct) {
        const extrasTotal = modalSelectedExtras.reduce((sum, e) => sum + e.price, 0);
        const total = (currentProduct.price + extrasTotal) * modalQuantity;
        document.getElementById('addToCartBtnText').textContent = `Tilf√∏j til kurv - ${total} kr.`;
      }
    }

    function addFromModal() {
      if (currentProduct) {
        // Calculate price including extras
        const extrasTotal = modalSelectedExtras.reduce((sum, e) => sum + e.price, 0);
        const itemPrice = currentProduct.price + extrasTotal;

        // Create customized product
        const customizedProduct = {
          ...currentProduct,
          price: itemPrice,
          basePrice: currentProduct.price,
          removedIngredients: [...modalRemovedIngredients],
          extras: [...modalSelectedExtras]
        };

        for (let i = 0; i < modalQuantity; i++) {
          addToCart(customizedProduct);
        }
        closeProductModal();
      }
    }

    // Close modal on backdrop click
    document.getElementById('productModal').addEventListener('click', function(e) {
      if (e.target === this) {
        closeProductModal();
      }
    });

    // ========================================
    // CONFIGURATION UPDATE (postMessage)
    // ========================================
    window.addEventListener('message', function(event) {
      if (event.data.type === 'UPDATE_CONFIG') {
        const config = event.data.config;

        // Update CSS variables for theme colors
        if (config.primaryColor) {
          document.documentElement.style.setProperty('--brand-primary', config.primaryColor);

          // Calculate darker shade for gradient
          const darkerShade = adjustColorBrightness(config.primaryColor, -20);
          document.documentElement.style.setProperty('--brand-primary-dark', darkerShade);
        }

        if (config.secondaryColor) {
          document.documentElement.style.setProperty('--brand-secondary', config.secondaryColor);
        }

        // Update app name
        if (config.appName) {
          const restaurantName = document.getElementById('restaurantName');
          const miniHeaderName = document.getElementById('miniHeaderName');

          if (restaurantName) restaurantName.textContent = config.appName;
          if (miniHeaderName) miniHeaderName.textContent = config.appName;

          // Update document title
          document.title = config.appName;
        }

        // Update tagline
        if (config.tagline) {
          const restaurantTagline = document.getElementById('restaurantTagline');
          if (restaurantTagline) restaurantTagline.textContent = config.tagline;
        }

        // Update logo
        if (config.logoUrl) {
          const miniHeaderLogo = document.getElementById('miniHeaderLogo');
          if (miniHeaderLogo) {
            miniHeaderLogo.style.backgroundImage = `url(${config.logoUrl})`;
            miniHeaderLogo.style.backgroundSize = 'cover';
            miniHeaderLogo.style.backgroundPosition = 'center';
            miniHeaderLogo.textContent = '';
          }
        } else if (config.appName) {
          // Show initials if no logo
          const miniHeaderLogo = document.getElementById('miniHeaderLogo');
          if (miniHeaderLogo && !config.logoUrl) {
            const words = config.appName.split(' ').filter(w => w.length > 0);
            const initials = words.slice(0, 2).map(w => w[0]).join('').toUpperCase() || 'PR';
            miniHeaderLogo.textContent = initials;
            miniHeaderLogo.style.backgroundImage = '';
          }
        }

        // Handle banner/header image
        if (config.hasOwnProperty('bannerUrl')) {
          const heroHeaderImage = document.getElementById('heroHeaderImage');
          const heroPlaceholder = document.getElementById('heroPlaceholder');

          if (config.bannerUrl) {
            heroHeaderImage.src = config.bannerUrl;
            heroHeaderImage.style.display = 'block';
            heroPlaceholder.style.display = 'none';
          } else {
            heroHeaderImage.style.display = 'none';
            heroPlaceholder.style.display = 'flex';
          }
        }
      }

      // Handle UPDATE_RESTAURANT_CONFIG from Web Builder
      if (event.data.type === 'UPDATE_RESTAURANT_CONFIG') {
        const config = event.data.config;

        // Update CSS variables for theme colors
        if (config.branding?.colors?.primary) {
          document.documentElement.style.setProperty('--brand-primary', config.branding.colors.primary);
          const darkerShade = adjustColorBrightness(config.branding.colors.primary, -20);
          document.documentElement.style.setProperty('--brand-primary-dark', darkerShade);
        }

        if (config.branding?.colors?.secondary) {
          document.documentElement.style.setProperty('--brand-secondary', config.branding.colors.secondary);
        }

        if (config.branding?.colors?.accent) {
          document.documentElement.style.setProperty('--brand-accent', config.branding.colors.accent);
        }

        // Update app name
        if (config.branding?.name) {
          const restaurantName = document.getElementById('restaurantName');
          const miniHeaderName = document.getElementById('miniHeaderName');
          if (restaurantName) restaurantName.textContent = config.branding.name;
          if (miniHeaderName) miniHeaderName.textContent = config.branding.name;
          document.title = config.branding.name;
        }

        // Update tagline/slogan
        if (config.branding?.slogan) {
          const restaurantTagline = document.getElementById('restaurantTagline');
          if (restaurantTagline) restaurantTagline.textContent = config.branding.slogan;
        }

        // Update logo
        if (config.branding?.logo) {
          const miniHeaderLogo = document.getElementById('miniHeaderLogo');
          if (miniHeaderLogo) {
            miniHeaderLogo.style.backgroundImage = `url(${config.branding.logo})`;
            miniHeaderLogo.style.backgroundSize = 'cover';
            miniHeaderLogo.style.backgroundPosition = 'center';
            miniHeaderLogo.textContent = '';
          }
        } else if (config.branding?.name) {
          const miniHeaderLogo = document.getElementById('miniHeaderLogo');
          if (miniHeaderLogo) {
            const words = config.branding.name.split(' ').filter(w => w.length > 0);
            const initials = words.slice(0, 2).map(w => w[0]).join('').toUpperCase() || 'PR';
            miniHeaderLogo.textContent = initials;
            miniHeaderLogo.style.backgroundImage = '';
          }
        }

        // Handle hero image
        const heroHeaderImage = document.getElementById('heroHeaderImage');
        const heroPlaceholder = document.getElementById('heroPlaceholder');
        if (config.images?.hero) {
          if (heroHeaderImage) {
            heroHeaderImage.src = config.images.hero;
            heroHeaderImage.style.display = 'block';
          }
          if (heroPlaceholder) heroPlaceholder.style.display = 'none';
        } else {
          if (heroHeaderImage) heroHeaderImage.style.display = 'none';
          if (heroPlaceholder) heroPlaceholder.style.display = 'flex';
        }

        // Handle hero overlay color and opacity
        if (config.images?.heroOverlay) {
          const overlay = document.querySelector('.hero-header-overlay');
          if (overlay) {
            const color = config.images.heroOverlay.color || '#000000';
            const opacity = config.images.heroOverlay.opacity || 0.4;
            // Convert hex to rgb for rgba
            const r = parseInt(color.slice(1, 3), 16);
            const g = parseInt(color.slice(3, 5), 16);
            const b = parseInt(color.slice(5, 7), 16);
            overlay.style.background = `linear-gradient(to bottom,
              rgba(${r}, ${g}, ${b}, ${opacity * 0.6}) 0%,
              rgba(${r}, ${g}, ${b}, 0) 25%,
              rgba(${r}, ${g}, ${b}, 0) 45%,
              rgba(${r}, ${g}, ${b}, ${opacity * 0.4}) 65%,
              rgba(${r}, ${g}, ${b}, ${opacity * 0.75}) 75%,
              rgba(255, 255, 255, 0.5) 88%,
              rgba(255, 255, 255, 0.85) 94%,
              rgba(255, 255, 255, 1) 100%)`;
          }
        }

        // Update fonts
        if (config.branding?.fonts) {
          if (config.branding.fonts.heading) {
            document.documentElement.style.setProperty('--font-heading', config.branding.fonts.heading);
            // Apply to headings
            document.querySelectorAll('h1, h2, h3, .restaurant-name').forEach(el => {
              el.style.fontFamily = config.branding.fonts.heading + ', serif';
            });
          }
          if (config.branding.fonts.body) {
            document.documentElement.style.setProperty('--font-body', config.branding.fonts.body);
            document.body.style.fontFamily = config.branding.fonts.body + ', sans-serif';
          }
        }
      }
    });

    // Helper function to adjust color brightness
    function adjustColorBrightness(color, amount) {
      const hex = color.replace('#', '');
      const r = Math.max(0, Math.min(255, parseInt(hex.substr(0, 2), 16) + amount));
      const g = Math.max(0, Math.min(255, parseInt(hex.substr(2, 2), 16) + amount));
      const b = Math.max(0, Math.min(255, parseInt(hex.substr(4, 2), 16) + amount));
      return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;
    }

    // ========================================
    // OFFERS FUNCTIONS
    // ========================================
    function renderOffers() {
      const container = document.getElementById('offersContent');
      if (!container) return;

      container.innerHTML = offers.map(offer => `
        <div class="offer-card">
          <div class="offer-card-header">
            <div class="offer-card-badge">
              <span>${offer.emoji}</span>
              ${offer.subtitle}
            </div>
            <h3 class="offer-card-title">${offer.title}</h3>
            <p class="offer-card-subtitle">${offer.description}</p>
          </div>
          <div class="offer-card-content">
            <div class="offer-card-prices">
              <span class="offer-original-price">${offer.originalPrice} kr.</span>
              <span class="offer-sale-price">${offer.salePrice} kr.</span>
            </div>
            <div class="offer-card-conditions">
              ${offer.conditions}
            </div>
            <button class="offer-add-btn" onclick="addOfferToCart(${offer.id})">
              Tilf√∏j til kurv - ${offer.salePrice} kr.
            </button>
          </div>
        </div>
      `).join('');
    }

    function addOfferToCart(offerId) {
      const offer = offers.find(o => o.id === offerId);
      if (offer) {
        addToCart({
          name: offer.title,
          price: offer.salePrice,
          emoji: offer.emoji,
          isOffer: true
        });
        // Show feedback
        alert(`${offer.title} er tilf√∏jet til din kurv!`);
      }
    }

    // ========================================
    // REWARDS FUNCTIONS
    // ========================================
    function renderRewards() {
      const container = document.getElementById('rewardsGrid');
      if (!container) return;

      container.innerHTML = rewards.map(reward => {
        const isAvailable = userPoints >= reward.cost;
        const statusClass = isAvailable ? 'available' : 'locked';

        return `
          <div class="reward-card ${statusClass}" onclick="${isAvailable ? `openRedeemModal(${reward.id})` : ''}">
            <div class="reward-emoji">${reward.emoji}</div>
            <div class="reward-name">${reward.name}</div>
            <div class="reward-points">${reward.cost} point</div>
            ${isAvailable ? '<div class="reward-status available-text">Tilg√¶ngelig</div>' : ''}
          </div>
        `;
      }).join('');
    }

    function updatePointsDisplay() {
      // Update all points displays
      const pointsValueLarge = document.querySelector('.points-value-large');
      const loyaltyPointsValue = document.querySelector('.loyalty-points-value');

      if (pointsValueLarge) pointsValueLarge.textContent = userPoints;
      if (loyaltyPointsValue) loyaltyPointsValue.textContent = userPoints;

      // Update progress bars
      const progressPercent = Math.min((userPoints / 1000) * 100, 100);
      const progressFills = document.querySelectorAll('.points-progress-large-fill, .loyalty-progress-fill');
      progressFills.forEach(fill => {
        fill.style.width = progressPercent + '%';
      });

      // Update progress text
      const pointsToGo = Math.max(0, 1000 - userPoints);
      const progressTexts = document.querySelectorAll('.points-progress-text span:first-child');
      progressTexts.forEach(text => {
        text.textContent = pointsToGo > 0 ? `${pointsToGo} point til gratis pizza` : 'Du kan indl√∏se en gratis pizza!';
      });

      // Re-render rewards to update available/locked states
      renderRewards();
    }

    let currentReward = null;

    function openRedeemModal(rewardId) {
      currentReward = rewards.find(r => r.id === rewardId);
      if (!currentReward || userPoints < currentReward.cost) return;

      const modal = document.getElementById('redeemModal');
      const pointsAfter = userPoints - currentReward.cost;

      document.getElementById('redeemRewardName').textContent = currentReward.name;
      document.getElementById('redeemRewardEmoji').textContent = currentReward.emoji;
      document.getElementById('redeemRewardCost').textContent = currentReward.cost + ' point';
      document.getElementById('redeemRewardDesc').textContent = currentReward.description;
      document.getElementById('redeemPointsAfter').textContent = pointsAfter + ' point';

      modal.classList.add('visible');
      document.body.style.overflow = 'hidden';
    }

    function closeRedeemModal() {
      const modal = document.getElementById('redeemModal');
      modal.classList.remove('visible');
      document.body.style.overflow = '';
      currentReward = null;
    }

    function confirmRedeem() {
      if (!currentReward || userPoints < currentReward.cost) return;

      // Deduct points
      userPoints -= currentReward.cost;

      // Add reward to cart as free item
      addToCart({
        name: currentReward.name,
        price: 0,
        emoji: currentReward.emoji,
        isReward: true,
        originalCost: currentReward.cost
      });

      // Update UI
      updatePointsDisplay();
      closeRedeemModal();

      // Show success message
      setTimeout(() => {
        alert(`${currentReward.name} er tilf√∏jet til din kurv!`);
      }, 300);
    }

    // ========================================
    // POINTS HISTORY FUNCTIONS
    // ========================================
    function renderPointsHistory() {
      const container = document.getElementById('pointsHistoryList');
      if (!container) return;

      container.innerHTML = pointsHistory.map(item => {
        const isPositive = item.points > 0;
        const pointsClass = isPositive ? 'positive' : 'negative';
        const pointsText = isPositive ? `+${item.points} point` : `${item.points} point`;

        let title = '';
        if (item.type === 'earned') {
          title = `Ordre #${item.id}`;
        } else {
          title = 'Indl√∏st bel√∏nning';
        }

        return `
          <div class="history-item" onclick="openHistoryDetail(${item.id || 'null'}, '${item.type}')" style="cursor: pointer;">
            <div class="history-info">
              <h4>${title}</h4>
              <span>${item.date}</span>
            </div>
            <span class="history-points ${pointsClass}">${pointsText}</span>
          </div>
        `;
      }).join('');
    }

    function openHistoryDetail(orderId, type) {
      const item = pointsHistory.find(h => h.id === orderId || (h.type === type && h.id === null));
      if (!item) return;

      let content = '';
      if (item.type === 'earned') {
        content = `
          <h3>Ordre #${item.id}</h3>
          <p class="history-detail-date">${item.date}</p>
          <div class="history-detail-items">
            <h4>Bestilte varer:</h4>
            <ul>
              ${item.items.map(i => `<li>${i}</li>`).join('')}
            </ul>
          </div>
          <div class="history-detail-points positive">+${item.points} point optjent</div>
          <button class="history-reorder-btn" onclick="closeHistoryDetail()">Bestil igen</button>
        `;
      } else {
        content = `
          <h3>Indl√∏st bel√∏nning</h3>
          <p class="history-detail-date">${item.date}</p>
          <div class="history-detail-reward">${item.reward}</div>
          <div class="history-detail-points negative">${item.points} point brugt</div>
          <button class="history-close-btn" onclick="closeHistoryDetail()">Luk</button>
        `;
      }

      const modal = document.getElementById('historyDetailModal');
      document.getElementById('historyDetailContent').innerHTML = content;
      modal.classList.add('visible');
      document.body.style.overflow = 'hidden';
    }

    function closeHistoryDetail() {
      const modal = document.getElementById('historyDetailModal');
      modal.classList.remove('visible');
      document.body.style.overflow = '';
    }

    // ========================================
    // INITIALIZATION
    // ========================================
    document.addEventListener('DOMContentLoaded', function() {
      updateCartUI();
      renderOffers();
      renderRewards();
      renderPointsHistory();
      switchView('homeView');

      // Initialize scroll state - ensure hero header is visible
      initializeScrollState();

      // Notify parent when PWA preview is ready
      if (window.parent !== window) {
        window.parent.postMessage({ type: 'PWA_READY' }, '*');
      }
    });

    // Reset scroll state to ensure correct initial display
    function initializeScrollState() {
      const appContent = document.getElementById('appContent');
      const heroHeader = document.getElementById('heroHeader');
      const miniHeader = document.getElementById('miniHeader');
      const miniHeaderSection = document.getElementById('miniHeaderSection');

      if (appContent) {
        // Reset scroll to top with requestAnimationFrame for better timing
        requestAnimationFrame(() => {
          appContent.scrollTop = 0;
        });
      }

      if (heroHeader) {
        // Ensure hero header is fully visible
        heroHeader.style.transition = 'none'; // Prevent animation on init
        heroHeader.style.opacity = '1';
        heroHeader.style.height = '280px';
        heroHeader.style.minHeight = '280px';

        // Re-enable transitions after initial state
        setTimeout(() => {
          heroHeader.style.transition = '';
        }, 50);
      }

      if (miniHeader) {
        // Ensure mini header is hidden
        miniHeader.classList.remove('visible');
      }

      if (miniHeaderSection) {
        miniHeaderSection.classList.remove('visible');
      }
    }

    // Listen for reset commands from parent
    window.addEventListener('message', (event) => {
      if (event.data?.type === 'RESET_SCROLL') {
        initializeScrollState();
      }
    });
  </script>
</body>
</html>
